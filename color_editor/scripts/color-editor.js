// Generated by CoffeeScript 1.3.3
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define(["helper/colors"],function(t){var n;return n=function(){function t(t,n){this.element=t;this.satLumDragstartHandler=e(this.satLumDragstartHandler,this);this.satLumDropHandler=e(this.satLumDropHandler,this);this.satLumDragHandler=e(this.satLumDragHandler,this);this.opacityClickHandler=e(this.opacityClickHandler,this);this.hueClickHandler=e(this.hueClickHandler,this);this.satLumClickHandler=e(this.satLumClickHandler,this);this.parseColor(n);$(this.element).children(".saturation-luminosity-block").click(this.satLumClickHandler);$(this.element).children(".hue-slider").click(this.hueClickHandler);$(this.element).children(".opacity-group").click(this.opacityClickHandler);$(this.element).children(".saturation-luminosity-block").bind("drag",this.satLumDragHandler);$(this.element).children(".saturation-luminosity-block").bind("dragstart",this.satLumDragstartHandler);$(this.element).children(".saturation-luminosity-block").bind("dragend",this.satLumDropHandler);$(this.element).children(".saturation-luminosity-block").bind("mouseup",this.satLumDropHandler)}t.prototype.parseColor=function(e){var t,n,r;if(e.match(/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i)){if(e.match(/^#?[a-f0-9]{3}$/i)){e=e.replace("#","");n=e.split("");e=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]}this.color=Colors.ColorFromHex(e)}else if(e.match(/^hsla?\((\d|,|%| |.)*\)$/i)){e=e.substring(e.indexOf("(")+1,e.indexOf(")"));e=e.replace(/( )/g,"");n=e.split(",");t=function(){var e,t,i;i=[];for(e=0,t=n.length;e<t;e++){r=n[e];i.push(this.parsePercentage(r))}return i}.call(this);this.color=Colors.ColorFromHSV(t[0],t[1],t[2])}else if(e.match(/^rgba?\((\d|,|%| |.)*\)$/i)){e=e.substring(e.indexOf("(")+1,e.indexOf(")"));e=e.replace(/( )/g,"");n=e.split(",");t=function(){var e,t,i;i=[];for(e=0,t=n.length;e<t;e++){r=n[e];i.push(this.parsePercentage(r))}return i}.call(this);this.color=Colors.ColorFromRGB(t[0],t[1],t[2])}return this.updateColor()};t.prototype.parsePercentage=function(e){t;var t;if(e.indexOf("%")!==-1){e=e.replace("%","");t=parseFloat(e)/100}else t=parseFloat(e);return t};t.prototype.updateColor=function(){var e;$(this.element).children(".saturation-luminosity-block").css("background","hsl("+this.color.Hue()+", 100%, 50%)");e="rgba("+this.color.Red()+","+this.color.Green()+","+this.color.Blue()+",0)";$(this.element).children(".opacity-group").children(".opacity-slider").css({background:"-webkit-linear-gradient(top, "+this.color.HexString()+", "+e+")"});$(this.element).children(".saturation-luminosity-block").children(".selector").css({left:String(this.color.Saturation()*100)+"%",bottom:String(this.color.Value()*100)+"%"});$(this.element).children(".hue-slider").children(".selector").css({bottom:String(this.color.Hue()/360*100)+"%"});$(this.element).children(".opacity-group").children(".selector").css({bottom:String(this.color.Alpha()*100)+"%"});return $(this.element).children(".color-indicator").children(".selected-color").css({background:"rgba("+this.color.Red()+","+this.color.Green()+","+this.color.Blue()+","+this.color.Alpha()+")"})};t.prototype.satLumClickHandler=function(e){this.color.SetHSV(this.color.Hue(),e.offsetX/150,1-e.offsetY/150);return this.updateColor()};t.prototype.hueClickHandler=function(e){this.color.SetHSV((1-e.offsetY/150)*360,this.color.Saturation(),this.color.Value());return this.updateColor()};t.prototype.opacityClickHandler=function(e){this.color.SetHSVA(this.color.Hue(),this.color.Saturation(),this.color.Value(),1-e.offsetY/150);return this.updateColor()};t.prototype.satLumDragHandler=function(e){var t,n;n=e.originalEvent.offsetY>=150?150:e.originalEvent.offsetY<0?0:e.originalEvent.offsetY;t=e.originalEvent.offsetX>=150?150:e.originalEvent.offsetX<0?0:e.originalEvent.offsetX;console.log(e);this.color.SetHSV(this.color.Hue(),t/150,1-n/150);this.updateColor();return e.originalEvent.preventDefault()};t.prototype.satLumDropHandler=function(e){this.color.SetHSV(this.color.Hue(),e.originalEvent.offsetX/150,1-e.originalEvent.offsetY/150);return this.updateColor()};t.prototype.satLumDragstartHandler=function(e){var t;t=document.createElement("img");t.src="/img/transparent_bg.svg";console.log($(t).css({display:"none"}));e.originalEvent.dataTransfer.setDragImage(t,-10,-10);e.originalEvent.dataTransfer.dropEffect="move";return console.log(e.originalEvent.dataTransfer)};return t}()})}).call(this);